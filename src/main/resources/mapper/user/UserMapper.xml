<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.cm39.cm39.user.mapper.UserMapper">
    <!--    userId로 회원 정보 조회-->
    <select id="selectUserByUserId" resultType="UserDto" parameterType="String">
        select *
        from cm39.User
        where user_id = #{userId}
    </select>

    <!--    refreshToken으로 회원 정보 조회-->
    <select id="selectUserByRefreshToken" resultType="UserDto" parameterType="String">
        select *
        from cm39.User
        where refresh_token = #{refreshToken}
    </select>

    <!--    모든 회원 정보 조회-->
    <select id="selectAllUser" resultType="UserDto">
        select *
        from cm39.User
    </select>

    <!--    회원가입-->
    <insert id="insertUser" parameterType="UserDto">
        INSERT INTO cm39.User (user_id, grd_id, pwd, user_name, birth, gndr, tel_no, user_stat_code, provider_type_code,
                               mnt_trms_agr_date, prsnl_info_agr_date, ad_info_rcv_agr_date,
                               signup_date, reg_date,
                               reg_id, up_date, up_id)
        VALUES (#{userId}, #{grdId}, #{pwd}, #{userName}, #{birth}, #{gndr}, #{telNo}, #{userStatCode},
                #{providerTypeCode},
                DATE_FORMAT(NOW(), '%Y-%m-%d %H:%i:%s'), DATE_FORMAT(NOW(), '%Y-%m-%d %H:%i:%s'),
                #{adInfoRcvAgrDate}, DATE_FORMAT(NOW(), '%Y-%m-%d %H:%i:%s'),
                DATE_FORMAT(NOW(), '%Y-%m-%d %H:%i:%s'), #{regId},
                DATE_FORMAT(NOW(), '%Y-%m-%d %H:%i:%s'), #{upId})
    </insert>

    <update id="updateRefreshToken" parameterType="map">
        UPDATE cm39.User
        SET refresh_token = #{refreshToken},
            up_date       = DATE_FORMAT(NOW(), '%Y-%m-%d %H:%i:%s'),
            up_id         = #{upId}
        WHERE user_id = #{userId}
    </update>

    <!--    회원 전체 삭제-->
    <delete id="deleteAllUser">
        delete
        from cm39.User
    </delete>
</mapper>
